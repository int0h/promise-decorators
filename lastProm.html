<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<script type="text/javascript" src="lodash.js"></script>
<script type="text/javascript" src="asyncTransform.js">

</script>

<button id='btn'>btn</button>



<svg id='logTable' width="1000" height="70">
	<defs>
      <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
        <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5"/>
      </pattern>
      <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">
        <rect width="100" height="100" fill="url(#smallGrid)"/>
        <path d="M 100 0 L 0 0 0 100" fill="none" stroke="gray" stroke-width="1"/>
      </pattern>
    </defs>
    <rect width="100%" height="100%" fill="url(#grid)" />
    <line id="cursor" x1="10" y1="0" x2="10" y2="70" />
</svg>
<link rel="stylesheet" type="text/css" href="svgLog.css">
<script type="text/javascript" src="svgLog.js"></script>


<script type="text/javascript">


	btn = document.getElementById('btn');

	var counter = 0;
	const pause = ms => new Promise(resolve => setTimeout(() => resolve(), ms));

	function _fetch(n){
		log('start', n - 1);
		return pause(200).then(() => {
			return n - 1;
		});
	}

	const tlFetch = takeLast(asyncTransform(_fetch, fn => _.throttle(fn, 500)));

	const onclick = () => {
		log('click', counter++)
		tlFetch(counter).then(n => log('end', n - 1));	
	}

	btn.onclick = onclick;
</script>

</body>
</html>